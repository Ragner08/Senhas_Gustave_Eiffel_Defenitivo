@model CalendarViewModel
@{
    ViewData["Title"] = "Calendário de Senhas";
    var culture = new System.Globalization.CultureInfo("pt-PT");
}

<div class="calendar-page">
    <!-- Título do Calendário -->
    <div class="calendar-header-section">
        <h1 class="calendar-title">Calendário de Senhas</h1>
    </div>

    <!-- Navegação do Mês -->
    <div class="month-navigation">
        <a asp-action="Index" asp-route-year="@(Model.Month - 1 == 0 ? Model.Year - 1 : Model.Year)" asp-route-month="@(Model.Month - 1 == 0 ? 12 : Model.Month - 1)" class="nav-arrow">
            <i class="bi bi-chevron-left"></i>
        </a>
        <h2 class="month-title">@char.ToUpper(Model.MonthName[0])@Model.MonthName.Substring(1) @Model.Year</h2>
        <a asp-action="Index" asp-route-year="@(Model.Month + 1 == 13 ? Model.Year + 1 : Model.Year)" asp-route-month="@(Model.Month + 1 == 13 ? 1 : Model.Month + 1)" class="nav-arrow">
            <i class="bi bi-chevron-right"></i>
        </a>
    </div>

    <!-- Calendário -->
    <div class="calendar-wrapper">
        <!-- Cabeçalho dos Dias da Semana -->
        <div class="weekdays-header">
            <div class="weekday">Seg</div>
            <div class="weekday">Ter</div>
            <div class="weekday">Qua</div>
            <div class="weekday">Qui</div>
            <div class="weekday">Sex</div>
            <div class="weekday">Sáb</div>
            <div class="weekday">Dom</div>
        </div>

        <!-- Grid dos Dias -->
        <div class="days-grid">
            @foreach (var day in Model.Days)
            {
                <a asp-action="DayDetails" asp-route-date="@day.Date.ToString("yyyy-MM-dd")"
                   class="day-cell @(day.IsCurrentMonth ? "" : "other-month")
                              @(day.IsToday ? "today" : "")
                              @(day.IsPast ? "past" : "")
                              @(day.HasBooking ? "has-booking" : "")
                              @(day.HasMeal ? "has-meal" : "")">
                    <span class="day-number">@day.Date.Day</span>
                    @if (day.HasMeal && !day.HasBooking && !day.IsPast)
                    {
                        <span class="day-dot meal-dot"></span>
                    }
                    @if (day.HasBooking)
                    {
                        <span class="day-dot booking-dot"></span>
                    }
                </a>
            }
        </div>
    </div>

    <!-- Legenda -->
    <div class="calendar-legend">
        <div class="legend-item">
            <span class="legend-dot today-dot"></span>
            <span>Hoje</span>
        </div>
        <div class="legend-item">
            <span class="legend-dot meal-dot"></span>
            <span>Refeição Disponível</span>
        </div>
        <div class="legend-item">
            <span class="legend-dot booking-dot"></span>
            <span>Senha Marcada</span>
        </div>
        <div class="legend-item">
            <span class="legend-dot past-dot"></span>
            <span>Dia Passado</span>
        </div>
    </div>

    <!-- Informações do Utilizador -->
    <div class="user-info-section">
        <div class="info-card">
            <div class="info-icon">
                <i class="bi bi-info-circle"></i>
            </div>
            <div class="info-content">
                <h5>Como Funciona</h5>
                <ul>
                    <li>Clique num dia para ver detalhes</li>
                    <li>Marque a sua senha com o seu escalão</li>
                    <li>O valor será descontado da carteira</li>
                    <li>Só pode marcar uma senha por dia</li>
                </ul>
            </div>
        </div>
        <div class="info-card">
            <div class="info-icon">
                <i class="bi bi-wallet2"></i>
            </div>
            <div class="info-content">
                <h5>O Meu Escalão</h5>
                <p><strong>Escalão Atual:</strong> <span class="badge-escalao">@Model.UserEscalao</span></p>
                <p class="text-muted">O preço da sua senha é calculado com base no seu escalão.</p>
            </div>
        </div>
    </div>
</div>
